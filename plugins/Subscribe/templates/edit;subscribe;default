__section__
default
__description__
Edit subscription information

* user = The user doing the editing, which may or may not be the
	user being edited (if not, it's an admin).
* user_edit = The user being edited.  Fields used are buypage_*
	and hits_{paidfor,bought,bought_today_max}.
* user_newvalues = Also passed in;  supercedes user_edit where its
	fields are present.
* pages = Arrayref of hashrefs, each hashref having fields:
	pagename = name of the page type to append to "buypage_"
	descr = description to print for page name

__title__

__page__
subscribe
__lang__
en_US
__name__
edit
__template__
<div id="slashboxes">
	[% PROCESS userboxes %]
</div>
<div id="users-blocks">
	[% prefs_titlebar %]
	<div class="generalbody">
	
		[% IF note %]
			<div class="message">
				[% note %]
			</div>
		[% END %]
		[% IF admin_flag %]
			[% admin_block %]
		[% END %]
		
		[% IF was_sub %]
			<fieldset>
				<legend>Subscription Info</legend>
				[% IF user.uid == user_edit.uid %]
					Your 
				[% ELSE %]
					User "[% user_edit.nickname | strip_literal %]" 
				[% END %]
				subscription
			
				[% IF subscriber %]
					ends
				[% ELSE %]
					ended
				[% END %]
				[% subscriber_until %] UTC. 
				
				[% IF user.uid == user_edit.uid && subscriber %]
					<br />Thank you for supporting [% constants.sitename %]! We appreciate your contribution very much.
				[% END %]
			</fieldset>
		[% END %]
	
		[% IF user.uid == user_edit.uid %]	
			[% PROCESS purchaseform %]
		[% END %]

		[% IF user.is_admin %]
			<form action="[% env.script_name %]">
				<fieldset>
					<legend>Grant Subscription</legend>
					<input type="hidden" name="uid" value="[% user_edit.uid %]">
					<p>Want to grant [% IF user.uid != user_edit.uid %]"[% user_edit.nickname | strip_literal %]"[% ELSE %]yourself[% END %]
					some subscription days? You're an admin, so grant as many as you want: <input type="text" name="days" value="0" size="6"></p>
					<p><input type="submit" name="op" value="Grant"><input type="hidden" name="userfield" value="[% userfield %]"></p>
				</fieldset>
			</form>
		[% END %]
		
		[% IF subscriber %]
			<form action="[% env.script_name %]">
				<fieldset>
					<legend>Subscription Preferences</legend>
					[% IF user.uid != user_edit.uid %]
						<input type="hidden" name="uid" value="[% user_edit.uid %]">
					[% END %]
					<label><input name="hide_subscription" type="checkbox" [% hs_check %]> Hide Subscription Indicator</label>
					<div class="note">Subscriber's comments are flagged with an indicator after their username. Check this box to hide display of your indicator.</div>
					<br />
					<div class="note">Set the delivery mode for subscription related messages:</div>
					[%
					messages = Slash.getObject('Slash::Messages');
					FOREACH type = bvmessagecodes.keys.sort;
						code = bvmessagecodes.$type.code;
						UNLESS messages.checkMessageUser(code, user_edit);
							NEXT;
						END %]
						<label>[% type %] <select name="deliverymodes_[% code %]">
							[% FOREACH valid_code = bvmessagecodes.$type.valid_bvdeliverymodes.sort %]
								<option value="[% valid_code %]"[% IF prefs.${code} == valid_code %] selected[% END %]>[% bvdeliverymodes.$valid_code.name %]</option>
							[% END %]
							</select>
						</label>
					[% END %]
					<br />
					<p><input type="submit" name="op" value="Save"><input type="hidden" name="userfield" value="[% userfield %]"></p>
				</fieldset>
			</form>
		[% END %]
		
		<p>If you have any questions or concerns about billing, or other subscription-related issues, please contact <a href="mailto:[% constants.subscribe_email %]">[%constants.subscribe_email %]</a>.</p>
	</div>
</div>
__seclev__
10000
__version__
$Id$
